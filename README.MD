# Gleitzsch

**Gleitzsch** is an iOS app for real-time glitch-art camera effects. It captures frames from the camera, optionally processes them (e.g. FFT-based distortions), and renders the result to the screen. Architecture is modular and ready for extension (e.g. video, filters, settings).

This README.md is written primarily for LLMs :).

---

## ğŸ”§ Architecture Overview

The project follows a streaming pipeline:

CameraManager
â†“
CIImage (oriented) â†’ CGImage
â†“
FrameProcessor (filters: gamma â†’ chromaticAberration â†’ FFT â†’ glitch â†’ iFFT)
â†“
FramePipeline (binds processing to UI)
â†“
CameraViewModel (exposes @Published frame)
â†“
SwiftUI ContentView (renders preview)

All processing is done off-main-thread. UI only observes and renders the latest frame.

---

## ğŸ§© Core Components

| File / Class            | Location                  | Purpose |
|-------------------------|---------------------------|---------|
| `CameraManager.swift`   | `Camera/`                 | Captures camera frames, converts to `CGImage`, orients image (`.right`) |
| `FrameProcessor.swift`  | `Processing/`             | Processes `CGImage` (currently passthrough, future: glitch filters) |
| `FramePipeline.swift`   | `Pipeline/`               | Connects `CameraManager` to `FrameProcessor`, publishes processed frames |
| `CameraViewModel.swift` | `ViewModels/`             | Observes `FramePipeline`, exposes `@Published currentFrame` for UI |
| `ContentView.swift`     | `Views/`                  | SwiftUI UI, displays image, capture button, reacts to device orientation |

---

## âš™ï¸ Frame Flow

Each captured frame goes through:

CIImage (oriented) â†’ gamma correction
â†’ chromatic aberration
â†’ FFT
â†’ glitch
â†’ iFFT â†’ CGImage

(Current implementation is passthrough; filter logic is to be added in `FrameProcessor.swift`.)

Frames are displayed using `.scaledToFill()` and `CGImage` is rotated using `.oriented(.right)` before conversion.


## ğŸ§ª Device Orientation

- Frames are always captured in landscape.
- The UI elements (e.g. buttons) are rotated using `UIDevice.orientationDidChangeNotification`.
- Captured images are saved with correct `UIImageOrientation` (`.right`) for EXIF consistency.

---

## ğŸ“ Project Structure

```
Gleitzsch/
â”œâ”€â”€ Camera/             // CameraManager and frame source
â”œâ”€â”€ Processing/         // FrameProcessor and future filters
â”œâ”€â”€ Pipeline/           // Data flow and coordination
â”œâ”€â”€ ViewModels/         // CameraViewModel â€” binds pipeline to UI
â”œâ”€â”€ Views/              // SwiftUI interface
â”œâ”€â”€ Utils/              // App-wide constants and helpers
â”œâ”€â”€ GleitzschApp.swift  // Entry point
```

## ğŸš§ Roadmap

- [ ] Implement FFT-based glitch filter
- [ ] Add intensity/config sliders
- [ ] Save processed video
- [ ] AppClip or LivePhoto support

---

